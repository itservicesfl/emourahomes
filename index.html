<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Free Home Value Estimate | EMoura Home Value</title>
    <meta name="description" content="Get a fast home value estimate. Enter your address and a few details to receive an instant estimate and a full report option." />
    <style>
        :root {
            --bg: #0b0f19;
            --card: rgba(255,255,255,0.06);
            --border: rgba(255,255,255,0.12);
            --text: rgba(255,255,255,0.90);
            --muted: rgba(255,255,255,0.70);
            --muted2: rgba(255,255,255,0.55);
            --brand: #4f7cff;
            --danger: #ff5a6a;
            --ok: #2bd576;
            --radius: 18px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
        }

        .wrap {
            max-width: 980px;
            margin: 0 auto;
            padding: 54px 18px;
        }

        .grid {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 18px;
            align-items: start;
        }

        @media (max-width: 900px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 26px;
        }

        h1 {
            margin: 0 0 10px;
            font-size: 34px;
        }

        p {
            margin: 0 0 18px;
            line-height: 1.55;
            color: var(--muted);
        }

        .muted {
            font-size: 12px;
            color: var(--muted2);
        }

        .stepbar {
            display: flex;
            gap: 8px;
            margin: 0 0 18px;
        }

        .dot {
            height: 8px;
            flex: 1;
            border-radius: 999px;
            background: rgba(255,255,255,0.14);
        }

            .dot.on {
                background: var(--brand);
            }

        label {
            display: block;
            font-size: 13px;
            color: var(--muted);
            margin: 0 0 6px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 12px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.16);
            background: rgba(0,0,0,0.25);
            color: var(--text);
            outline: none;
        }

        textarea {
            min-height: 90px;
            resize: vertical;
        }

        input::placeholder {
            color: rgba(255,255,255,0.40);
        }

        .row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .col {
            flex: 1;
            min-width: 220px;
        }

        .btnrow {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-top: 14px;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-block;
            background: var(--brand);
            color: #fff;
            padding: 12px 16px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 800;
            border: 0;
            cursor: pointer;
        }

            .btn.secondary {
                background: transparent;
                border: 1px solid rgba(255,255,255,0.18);
            }

        .error {
            margin-top: 10px;
            color: var(--danger);
            font-size: 13px;
            display: none;
        }

        .ok {
            color: var(--ok);
            font-size: 13px;
            display: none;
            margin-top: 10px;
        }

        .side h3 {
            margin: 0 0 10px;
            font-size: 18px;
        }

        .side ul {
            margin: 0;
            padding-left: 18px;
            color: var(--muted);
            line-height: 1.55;
        }

        .side li {
            margin: 8px 0;
        }

        .badge {
            display: inline-block;
            font-size: 12px;
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid rgba(255,255,255,0.18);
            color: var(--muted);
            margin-bottom: 10px;
        }

        .hidden {
            display: none;
        }

        .divider {
            height: 1px;
            background: rgba(255,255,255,0.12);
            margin: 16px 0;
        }

        .chiprow {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .chip {
            display: inline-flex;
            gap: 8px;
            align-items: center;
            padding: 10px 12px;
            border: 1px solid rgba(255,255,255,0.16);
            border-radius: 999px;
            background: rgba(0,0,0,0.18);
            cursor: pointer;
            user-select: none;
        }

            .chip input {
                width: auto;
            }

        /* Progress */
        .progressWrap {
            margin-top: 10px;
        }

        .bar {
            width: 100%;
            height: 12px;
            border-radius: 999px;
            background: rgba(255,255,255,0.12);
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.12);
        }

            .bar > div {
                height: 100%;
                width: 0%;
                background: var(--brand);
                transition: width 250ms ease;
            }

        .status {
            margin-top: 10px;
            color: var(--muted);
        }

        /* Result */
        .valueBox {
            margin-top: 10px;
            padding: 18px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.14);
            background: rgba(0,0,0,0.20);
        }

        .valueBig {
            font-size: 38px;
            font-weight: 900;
            letter-spacing: 0.2px;
            margin: 6px 0 0;
        }

        .valueSmall {
            color: var(--muted);
            margin: 6px 0 0;
        }
    </style>
</head>
<body>
    <div class="wrap">
        <div class="grid">
            <div class="card">
                <div class="stepbar" aria-label="Progress">
                    <div class="dot on" id="dot1"></div>
                    <div class="dot" id="dot2"></div>
                    <div class="dot" id="dot3"></div>
                    <div class="dot" id="dot4"></div>
                </div>

                <h1 id="title">Get your home value estimate</h1>
                <p id="subtitle">Start by entering the property address. Then we’ll ask a few quick details and generate an estimate.</p>

                <!-- STEP 1 -->
                <form id="step1">
                    <div class="row">
                        <div class="col">
                            <label for="address">Property address</label>
                            <input id="address" name="address" placeholder="123 Main St, City, State" autocomplete="street-address" />
                        </div>

                        <div class="col">
                            <label for="ptype">Property type</label>
                            <select id="ptype" name="ptype">
                                <option value="">Select…</option>
                                <option>Single-family home</option>
                                <option>Condo / Apartment</option>
                                <option>Townhome</option>
                                <option>Multi-family</option>
                                <option>Land</option>
                                <option>Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="btnrow">
                        <button class="btn" type="submit">Continue</button>
                        <a class="btn secondary" href="https://www.emourahomes.com" target="_blank" rel="noreferrer">Visit EMouraHomes.com</a>
                        <span class="muted">Nationwide USA</span>
                    </div>

                    <div class="error" id="err1"></div>
                    <div class="ok" id="ok1"></div>
                </form>

                <!-- STEP 2 -->
                <form id="step2" class="hidden">
                    <div class="row">
                        <div class="col">
                            <label for="sqft">Total living area (sqft)</label>
                            <input id="sqft" name="sqft" inputmode="numeric" placeholder="e.g., 1850" />
                        </div>
                        <div class="col">
                            <label for="beds">Bedrooms</label>
                            <input id="beds" name="beds" inputmode="numeric" placeholder="e.g., 3" />
                        </div>
                        <div class="col">
                            <label for="baths">Bathrooms</label>
                            <input id="baths" name="baths" inputmode="decimal" placeholder="e.g., 2 or 2.5" />
                        </div>
                    </div>

                    <div class="divider"></div>

                    <label>Features</label>
                    <div class="chiprow">
                        <label class="chip"><input type="checkbox" id="balcony" /> Balcony / Patio</label>
                        <label class="chip"><input type="checkbox" id="pool" /> Pool</label>
                        <label class="chip"><input type="checkbox" id="kitchen" /> Updated Kitchen</label>
                        <label class="chip"><input type="checkbox" id="living" /> Large Living Room</label>
                    </div>

                    <div class="row" style="margin-top:14px;">
                        <div class="col">
                            <label for="garageSpots">Garage / Parking spots</label>
                            <select id="garageSpots">
                                <option value="">Select…</option>
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3+</option>
                            </select>
                        </div>

                        <div class="col">
                            <label for="hoa">Condo/HOA fee?</label>
                            <select id="hoa">
                                <option value="">Select…</option>
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                        </div>

                        <div class="col" id="hoaAmountWrap" style="display:none;">
                            <label for="hoaAmount">Monthly HOA/Condo fee (USD)</label>
                            <input id="hoaAmount" inputmode="numeric" placeholder="e.g., 650" />
                        </div>
                    </div>

                    <div class="btnrow">
                        <button class="btn secondary" type="button" id="backTo1">Back</button>
                        <button class="btn" type="submit">Continue</button>
                        <span class="muted">Step 2 of 4</span>
                    </div>

                    <div class="error" id="err2"></div>
                    <div class="ok" id="ok2"></div>
                </form>

                <!-- STEP 3: PROCESSING -->
                <div id="step3" class="hidden">
                    <div class="valueBox">
                        <div class="muted">Processing</div>
                        <div style="font-size:20px;font-weight:900;margin-top:6px;">We’re evaluating your property…</div>

                        <div class="progressWrap">
                            <div class="bar"><div id="barFill"></div></div>
                            <div class="status" id="statusLine">Starting analysis…</div>
                        </div>

                        <div class="btnrow" style="margin-top:18px;">
                            <button class="btn secondary" id="backTo2" type="button">Back</button>
                            <span class="muted">Step 3 of 4</span>
                        </div>
                    </div>
                </div>

                <!-- STEP 4: RESULT + CTAs -->
                <div id="step4" class="hidden">
                    <div class="valueBox">
                        <div class="muted">Evaluation Complete</div>
                        <div style="font-size:20px;font-weight:900;margin-top:6px;">Your Home Worth is</div>
                        <div class="valueBig" id="estimateValue">$—</div>
                        <div class="valueSmall" id="estimateRange">Estimated range: —</div>
                    </div>

                    <div class="divider"></div>

                    <div class="row">
                        <div class="col">
                            <h3 style="margin:0 0 10px;">Email me the full report</h3>
                            <form id="emailCta">
                                <label for="name1">Full name</label>
                                <input id="name1" placeholder="Your name" />
                                <div style="height:10px;"></div>
                                <label for="email1">Email</label>
                                <input id="email1" type="email" placeholder="you@email.com" />
                                <div class="btnrow">
                                    <button class="btn" type="submit">Send report</button>
                                </div>
                                <div class="error" id="errEmail"></div>
                                <div class="ok" id="okEmail"></div>
                            </form>
                        </div>

                        <div class="col">
                            <h3 style="margin:0 0 10px;">Talk to a specialist</h3>
                            <form id="callCta">
                                <label for="name2">Full name</label>
                                <input id="name2" placeholder="Your name" />
                                <div style="height:10px;"></div>
                                <label for="phone2">Phone</label>
                                <input id="phone2" placeholder="(555) 555-5555" />
                                <div style="height:10px;"></div>
                                <label for="best2">Best time to call</label>
                                <select id="best2">
                                    <option value="">Select…</option>
                                    <option>Morning</option>
                                    <option>Afternoon</option>
                                    <option>Evening</option>
                                </select>
                                <div class="btnrow">
                                    <button class="btn" type="submit">Request call</button>
                                </div>
                                <div class="error" id="errCall"></div>
                                <div class="ok" id="okCall"></div>
                            </form>
                        </div>
                    </div>

                    <div class="btnrow" style="margin-top:16px;">
                        <a class="btn" id="finishLink" href="https://www.emourahomes.com">Continue to EMouraHomes.com</a>
                        <span class="muted">Step 4 of 4</span>
                    </div>

                    <div class="muted" style="margin-top:14px;">
                        Note: This estimate is based on your inputs and local market averages. Next step will connect this to our backend API.
                    </div>
                </div>

                <div class="muted" style="margin-top:18px;">
                    By continuing, you agree that this is an estimate based on information provided and local market averages.
                </div>
            </div>

            <div class="card side">
                <div class="badge" id="sideBadge">How it works</div>
                <h3 id="sideTitle">Fast & simple</h3>
                <ul id="sideList">
                    <li>Enter your address</li>
                    <li>Add property details (sqft, beds, baths, amenities)</li>
                    <li>We compare with similar properties nationwide</li>
                    <li>You get an estimate + option for full report</li>
                </ul>
                <div class="muted" style="margin-top:14px;" id="sideNote">
                    Next: we’ll add a “processing” screen and then the results + lead capture.
                </div>
            </div>
        </div>
    </div>

    <script>
        const $ = (id) => document.getElementById(id);

        const step1 = $('step1');
        const step2 = $('step2');
        const step3 = $('step3');
        const step4 = $('step4');

        const err1 = $('err1');
        const ok1 = $('ok1');
        const err2 = $('err2');
        const ok2 = $('ok2');

        function setDots(activeStep) {
            for (let i = 1; i <= 4; i++) {
                const d = $('dot' + i);
                if (!d) continue;
                d.classList.toggle('on', i <= activeStep);
            }
        }

        function showError(el, msg) { el.textContent = msg; el.style.display = 'block'; }
        function hideError(el) { el.style.display = 'none'; el.textContent = ''; }
        function showOk(el, msg) { el.textContent = msg; el.style.display = 'block'; }
        function hideOk(el) { el.style.display = 'none'; el.textContent = ''; }

        function getDraft() {
            try { return JSON.parse(localStorage.getItem('emhv_lead_draft') || '{}'); }
            catch { return {}; }
        }
        function setDraft(patch) {
            const cur = getDraft();
            const next = { ...cur, ...patch, updatedAt: new Date().toISOString() };
            localStorage.setItem('emhv_lead_draft', JSON.stringify(next));
            return next;
        }

        function showOnly(which) {
            [step1, step2, step3, step4].forEach(el => el.classList.add('hidden'));
            which.classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function goStep(n) {
            if (n === 1) { setDots(1); $('subtitle').textContent = 'Start by entering the property address. Then we’ll ask a few quick details and generate an estimate.'; showOnly(step1); }
            if (n === 2) { setDots(2); $('subtitle').textContent = 'Add a few property details so the estimate is more accurate.'; showOnly(step2); }
            if (n === 3) { setDots(3); $('subtitle').textContent = 'We are evaluating properties like yours in the area.'; showOnly(step3); startProcessing(); }
            if (n === 4) { setDots(4); $('subtitle').textContent = 'Your estimate is ready. Choose how you want the full evaluation.'; showOnly(step4); }
        }

        // Prefill from draft
        (function prefill() {
            const d = getDraft();
            if (d.address) $('address').value = d.address;
            if (d.ptype) $('ptype').value = d.ptype;
            if (d.sqft) $('sqft').value = d.sqft;
            if (d.beds) $('beds').value = d.beds;
            if (d.baths) $('baths').value = d.baths;
            if (d.features) {
                $('balcony').checked = !!d.features.balcony;
                $('pool').checked = !!d.features.pool;
                $('kitchen').checked = !!d.features.kitchen;
                $('living').checked = !!d.features.living;
            }
            if (typeof d.garageSpots !== 'undefined' && d.garageSpots !== null) $('garageSpots').value = String(d.garageSpots);
            if (d.hoa) $('hoa').value = d.hoa;
            if (d.hoa === 'yes') $('hoaAmountWrap').style.display = 'block';
            if (d.hoaAmount) $('hoaAmount').value = d.hoaAmount;
        })();

        // STEP 1 submit
        step1.addEventListener('submit', (e) => {
            e.preventDefault();
            hideError(err1); hideOk(ok1);

            const address = $('address').value.trim();
            const ptype = $('ptype').value.trim();

            if (!address || address.length < 6) return showError(err1, 'Please enter a valid property address.');
            if (!ptype) return showError(err1, 'Please select a property type.');

            setDraft({ address, ptype, startedAt: getDraft().startedAt || new Date().toISOString() });
            showOk(ok1, 'Saved. Continue to add property details.');
            goStep(2);
        });

        // HOA show/hide amount
        $('hoa').addEventListener('change', () => {
            const v = $('hoa').value;
            $('hoaAmountWrap').style.display = (v === 'yes') ? 'block' : 'none';
            if (v !== 'yes') $('hoaAmount').value = '';
        });

        // Back buttons
        $('backTo1').addEventListener('click', () => goStep(1));
        $('backTo2').addEventListener('click', () => goStep(2));        

        // STEP 2 submit
        step2.addEventListener('submit', (e) => {
            e.preventDefault();
            hideError(err2); hideOk(ok2);

            const sqft = $('sqft').value.trim();
            const beds = $('beds').value.trim();
            const baths = $('baths').value.trim();

            const sqftNum = Number(sqft);
            if (!sqft || Number.isNaN(sqftNum) || sqftNum < 200) return showError(err2, 'Please enter a valid sqft (example: 1850).');

            const bedsNum = Number(beds);
            if (!beds || Number.isNaN(bedsNum) || bedsNum < 0 || bedsNum > 30) return showError(err2, 'Please enter valid bedrooms (example: 3).');

            const bathsNum = Number(baths);
            if (!baths || Number.isNaN(bathsNum) || bathsNum < 0 || bathsNum > 30) return showError(err2, 'Please enter valid bathrooms (example: 2 or 2.5).');

            const features = {
                balcony: $('balcony').checked,
                pool: $('pool').checked,
                kitchen: $('kitchen').checked,
                living: $('living').checked
            };

            const garageSpots = $('garageSpots').value === '' ? null : Number($('garageSpots').value);
            const hoa = $('hoa').value;
            let hoaAmount = null;

            if (!hoa) return showError(err2, 'Please select whether there is a Condo/HOA fee.');
            if (hoa === 'yes') {
                const amt = $('hoaAmount').value.trim();
                const amtNum = Number(amt);
                if (!amt || Number.isNaN(amtNum) || amtNum < 1) return showError(err2, 'Please enter a valid monthly HOA amount.');
                hoaAmount = amtNum;
            }

            setDraft({ sqft: sqftNum, beds: bedsNum, baths: bathsNum, features, garageSpots, hoa, hoaAmount });
            showOk(ok2, 'Saved. Generating estimate…');

            // Go to Processing
            goStep(3);
        });

        // Mock estimate logic (temporary)
        function computeMockEstimate(d) {
            // VERY rough placeholder so we can complete the flow.
            // Next step we replace this with /api/estimate (Cloudflare Worker + KV).
            let basePPSF = 240; // generic nationwide starter
            if (d.ptype && String(d.ptype).toLowerCase().includes('condo')) basePPSF = 260;

            let val = (Number(d.sqft || 0) * basePPSF);

            // Simple feature bumps
            if (d.features?.pool) val *= 1.05;
            if (d.features?.balcony) val *= 1.02;
            if (d.features?.kitchen) val *= 1.03;
            if (d.garageSpots === 1) val *= 1.01;
            if (d.garageSpots === 2) val *= 1.02;
            if (d.garageSpots === 3) val *= 1.03;

            // HOA slight adjustment (placeholder)
            if (d.hoa === 'yes' && d.hoaAmount) {
                const hoa = Number(d.hoaAmount);
                if (hoa > 1200) val *= 0.97;
                else if (hoa > 700) val *= 0.985;
            }

            const low = val * 0.92;
            const high = val * 1.08;
            return { val, low, high };
        }

        // Processing animation
        let timer = null;
        function startProcessing() {
            if (timer) clearInterval(timer);

            const barFill = $('barFill');
            const statusLine = $('statusLine');

            const messages = [
                'Verifying the address…',
                'Gathering local market averages…',
                'Comparing properties like yours…',
                'Adjusting for size and features…',
                'Analyzing HOA/condo costs…',
                'Finalizing your estimate…'
            ];

            let pct = 0;
            let msgIndex = 0;
            statusLine.textContent = messages[0];
            barFill.style.width = '0%';

            timer = setInterval(() => {
                pct += 4; // ~6-7 seconds total
                if (pct > 100) pct = 100;
                barFill.style.width = pct + '%';

                if (pct % 16 === 0 && msgIndex < messages.length - 1) {
                    msgIndex++;
                    statusLine.textContent = messages[msgIndex];
                }

                if (pct >= 100) {
                    clearInterval(timer);
                    timer = null;

                    const d = getDraft();
                    const est = computeMockEstimate(d);
                    const format = (n) => n.toLocaleString('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 });

                    $('estimateValue').textContent = format(est.val);
                    $('estimateRange').textContent = `Estimated range: ${format(est.low)} – ${format(est.high)}`;

                    setDraft({ estimate: { value: est.val, low: est.low, high: est.high, isMock: true } });
                    goStep(4);
                }
            }, 250);
        }

        // CTA Forms (temporary: show success and enable redirect)
        function clearCtaMessages() {
            ['errEmail', 'okEmail', 'errCall', 'okCall'].forEach(id => { $(id).style.display = 'none'; $(id).textContent = ''; });
        }
        function showCtaError(id, msg) { $(id).textContent = msg; $(id).style.display = 'block'; }
        function showCtaOk(id, msg) { $(id).textContent = msg; $(id).style.display = 'block'; }

        $('emailCta').addEventListener('submit', (e) => {
            e.preventDefault();
            clearCtaMessages();
            const name = $('name1').value.trim();
            const email = $('email1').value.trim();
            if (!name) return showCtaError('errEmail', 'Please enter your name.');
            if (!email || !email.includes('@')) return showCtaError('errEmail', 'Please enter a valid email.');

            setDraft({ leadChoice: 'email_report', lead: { name, email } });
            showCtaOk('okEmail', 'Saved. Next step: we will send this to our backend (Formspree via Worker).');

            // Optional auto-redirect after a short delay
            setTimeout(() => { window.location.href = 'https://www.emourahomes.com'; }, 1200);
        });

        $('callCta').addEventListener('submit', (e) => {
            e.preventDefault();
            clearCtaMessages();
            const name = $('name2').value.trim();
            const phone = $('phone2').value.trim();
            const best = $('best2').value.trim();
            if (!name) return showCtaError('errCall', 'Please enter your name.');
            if (!phone || phone.length < 7) return showCtaError('errCall', 'Please enter a valid phone number.');
            if (!best) return showCtaError('errCall', 'Please select the best time to call.');

            setDraft({ leadChoice: 'specialist_call', lead: { name, phone, best } });
            showCtaOk('okCall', 'Saved. Next step: we will send this to our backend (Formspree via Worker).');

            setTimeout(() => { window.location.href = 'https://www.emourahomes.com'; }, 1200);
        });

        // Auto-step: if step2 is complete, stay there; if estimate exists, show results
        (function autoStep() {
            const d = getDraft();
            if (d.estimate && d.estimate.value) return goStep(4);
            if (d.address && d.ptype) return goStep(2);
            goStep(1);
        })();
    </script>
</body>
</html>
